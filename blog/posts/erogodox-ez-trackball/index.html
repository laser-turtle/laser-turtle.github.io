<!DOCTYPE html>
<html lang="">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>ErgoDox EZ Trackball Mod - A Blog</title><meta name="Description" content="A blog description"><meta property="og:title" content="ErgoDox EZ Trackball Mod" />
<meta property="og:description" content="Introduction Recently I purchased an ErgoDox EZ ergonomic keyboard. I figured if I&rsquo;m going to spend all my time at the computer, might as well save my wrists. I was also excited about the open source nature of the ErgoDox and the rave reviews." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/blog/posts/erogodox-ez-trackball/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-08-29T21:45:30+00:00" />
<meta property="article:modified_time" content="2020-08-29T21:45:30+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="ErgoDox EZ Trackball Mod"/>
<meta name="twitter:description" content="Introduction Recently I purchased an ErgoDox EZ ergonomic keyboard. I figured if I&rsquo;m going to spend all my time at the computer, might as well save my wrists. I was also excited about the open source nature of the ErgoDox and the rave reviews."/>
<meta name="application-name" content="A Blog">
<meta name="apple-mobile-web-app-title" content="A Blog"><link rel="shortcut icon" type="image/x-icon" href="/blog/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/blog/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/blog/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/blog/apple-touch-icon.png"><link rel="manifest" href="/blog/site.webmanifest"><link rel="canonical" href="/blog/posts/erogodox-ez-trackball/" /><link rel="prev" href="/blog/blog/posts/incr-dom-3/" /><link rel="next" href="/blog/blog/posts/math-battle/" /><link rel="stylesheet" href="/blog/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/blog/css/style.min.css"><link rel="stylesheet" href="/blog/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/blog/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "ErgoDox EZ Trackball Mod",
        "inLanguage": "",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "\/blog\/posts\/erogodox-ez-trackball\/"
        },"genre": "posts","wordcount":  1063 ,
        "url": "\/blog\/posts\/erogodox-ez-trackball\/","datePublished": "2020-08-29T21:45:30+00:00","dateModified": "2020-08-29T21:45:30+00:00","license": "Copyright \u0026copy; 2022 - Laser Turtle","publisher": {
            "@type": "Organization",
            "name": "Author"},"author": {
                "@type": "Person",
                "name": "Author"
            },"description": ""
    }
    </script></head>
    <body header-desktop="" header-mobile=""><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : '' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/blog/" title="A Blog">A Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/blog/"> Home </a><a class="menu-item" href="/blog/posts/"> Posts </a><a class="menu-item" href="/blog/about/" title="About"> About </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/blog/" title="A Blog">A Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/blog/" title="">Home</a><a class="menu-item" href="/blog/posts/" title="">Posts</a><a class="menu-item" href="/blog/about/" title="About">About</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title">ErgoDox EZ Trackball Mod</h1><div class="post-meta">
            <div class="post-meta-line"></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2020-08-29">2020-08-29</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;1063 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;5 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#steps">Steps</a>
      <ul>
        <li><a href="#schematic">Schematic</a></li>
        <li><a href="#pcb">PCB</a></li>
        <li><a href="#trackball">Trackball</a></li>
        <li><a href="#result">Result</a></li>
      </ul>
    </li>
    <li><a href="#final-remarks">Final Remarks</a></li>
    <li><a href="#code">Code</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="introduction">Introduction</h2>
<p>Recently I purchased an <a href="https://ergodox-ez.com/" target="_blank" rel="noopener noreffer">ErgoDox EZ</a> ergonomic keyboard. I figured if I&rsquo;m going to spend all my time at the computer, might as well save my wrists. I was also excited about the open source nature of the ErgoDox and the rave reviews. I have a friend who&rsquo;s used one for years and loves it. I almost purchased the new Moonlander, but there weren&rsquo;t enough reviews yet, so I went with the EZ.</p>
<p>After using the EZ for a bit I was still unhappy with how often my hand was leaving the keyboard for the mouse. A lot of applications have decent keyboard shortcuts and using something like <a href="https://vimium.github.io/" target="_blank" rel="noopener noreffer">Vimium</a> helps, but can&rsquo;t beat a mouse for some tasks. I wanted a way to integrate a trackpad or trackball into the EZ. I went searching around for small trackballs and trackapd breakout boards that might be usable and stumbled upon the <a href="https://www.digikey.com/catalog/en/partgroup/trackball-breakout-board/90540" target="_blank" rel="noopener noreffer">Pimoroni trackball breakout board</a>. There were some others but this one looked the smallest and easiest to use.</p>
<p>Originally I was going to use a Raspberry Pi Zero to act like a mouse because it supports <a href="https://learn.adafruit.com/turning-your-raspberry-pi-zero-into-a-usb-gadget" target="_blank" rel="noopener noreffer">gadget mode</a> which uses the Linux gadget mode support to emulate a USB device. This means you could use the pi to relay the trackball events over USB and act like a normal mouse. Then the trackball could be attached somewhere on the ErgoDox and be a nice mouse addon. Only downside is the mouse is not really integrated and would take two USB slots to use. Thankfully doing some more searching I stumbled upon <a href="https://www.reddit.com/r/ergodox/comments/gsnhb5/an_ergodox_with_an_integrated_trackpadtrackball/" target="_blank" rel="noopener noreffer">this Reddit post</a> where a user <code>drashna</code> had done a similar mod <em>with the same trackball!</em>.</p>
<p>This was fantastic news, and reading the thread <code>drashna</code> explains that the TRRS jack of the ErgoDox is an <a href="https://en.wikipedia.org/wiki/I%C2%B2C" target="_blank" rel="noopener noreffer">I2C Bus</a> and since the trackball is also an I2C device you can solder some wires onto the appropriate jack locations and get the trackball talking on the bus! Even better was <code>drashna</code> had already implemented a driver for it in the ErgoDox firmware, which can be found here: <a href="https://github.com/qmk/qmk_firmware/blob/357a888d805c21c9cb4917f55d558195e8b85db5/users/drashna/pimoroni_trackball.c" target="_blank" rel="noopener noreffer">drashna trackball code</a></p>
<h2 id="steps">Steps</h2>
<h3 id="schematic">Schematic</h3>
<p>Here&rsquo;s the basic steps:</p>
<ol>
<li>Find the schematic for the ErgoDox EZ so we can look at the TRRS jack connections:
<a href="https://github.com/zsa/docs/blob/master/Ergodox%20V5-R.pdf" target="_blank" rel="noopener noreffer">ErgoDox EZ Right Half Schematic Link</a></li>
</ol>
<p><img
        class="lazyload"
        src="/blog/svg/loading.min.svg"
        data-src="/blog/images/ergodox_ez_right_schematic.png"
        data-srcset="/blog/images/ergodox_ez_right_schematic.png, /blog/images/ergodox_ez_right_schematic.png 1.5x, /blog/images/ergodox_ez_right_schematic.png 2x"
        data-sizes="auto"
        alt="/images/ergodox_ez_right_schematic.png"
        title="ErgoDox EZ right schematic screenshot" /></p>
<p>In this image you can see the TRRS jack on the right with pins 1-6. We see that</p>
<pre tabindex="0"><code>pin 1 - Ground
pin 2 &amp; 6 - VCC
pin 3 &amp; 5 - Connected to Lx -&gt; Sx -&gt; SDA
pin 4 - Connected to Ly -&gt; Sy -&gt; SCL
</code></pre><p>The important ones are pins 1, 2, 3, 4 as we&rsquo;ll see when we look at the Pimoroni schematic.</p>
<h3 id="pcb">PCB</h3>
<ol start="2">
<li>Now we can take a look at the physical board and a schematic of the TRRS jack to figure out which solder joints we can co-opt for our trackball:</li>
</ol>
<p><img
        class="lazyload"
        src="/blog/svg/loading.min.svg"
        data-src="/blog/images/ergodox_ez_pcb_labeled.png"
        data-srcset="/blog/images/ergodox_ez_pcb_labeled.png, /blog/images/ergodox_ez_pcb_labeled.png 1.5x, /blog/images/ergodox_ez_pcb_labeled.png 2x"
        data-sizes="auto"
        alt="/images/ergodox_ez_pcb_labeled.png"
        title="ErgoDox EZ physical schematic" /></p>
<p>I&rsquo;ve labeled the joints on the jack that we can use for our trackball. This can be found out by finding the TRRS jacked used in the ErgoDox EZ: <a href="https://www.ergodox.io/" target="_blank" rel="noopener noreffer">See section 2.1.0.2</a> and we find the part is <a href="https://www.digikey.com/product-detail/en/cui-devices/SJ-43514/CP-43514-ND/368146" target="_blank" rel="noopener noreffer">CP-43514</a> which has the datasheet that shows the pinout connections:</p>
<p><img
        class="lazyload"
        src="/blog/svg/loading.min.svg"
        data-src="/blog/images/trrs_jack_datasheet.png"
        data-srcset="/blog/images/trrs_jack_datasheet.png, /blog/images/trrs_jack_datasheet.png 1.5x, /blog/images/trrs_jack_datasheet.png 2x"
        data-sizes="auto"
        alt="/images/trrs_jack_datasheet.png"
        title="TRRS Jack Pinout" /></p>
<p>Remember that this is a top-down view and the PCB is a bottom-up view, so the pins are actually mirrored. Comparing the ErgoDox EZ schematic with the physical PCB and datasheet we arrive at the pin uses listed earlier.</p>
<h3 id="trackball">Trackball</h3>
<ol start="3">
<li>Now that we know what to hook up its a simple matter of wiring the Pimoroni pins to the proper locations on the ErgoDox EZ jack. Unfortunately I don&rsquo;t have a picture of my solder job as I forgot to take it before putting the case together.</li>
</ol>
<p><img
        class="lazyload"
        src="/blog/svg/loading.min.svg"
        data-src="/blog/images/pimoroni_trackball.png"
        data-srcset="/blog/images/pimoroni_trackball.png, /blog/images/pimoroni_trackball.png 1.5x, /blog/images/pimoroni_trackball.png 2x"
        data-sizes="auto"
        alt="/images/pimoroni_trackball.png"
        title="Pimoroni Trackball" /></p>
<h3 id="result">Result</h3>
<ol start="4">
<li>Here&rsquo;s what mine looks like after reassembling the case:</li>
</ol>
<p><img
        class="lazyload"
        src="/blog/svg/loading.min.svg"
        data-src="/blog/images/ergodox_ez_final_with_mouse.png"
        data-srcset="/blog/images/ergodox_ez_final_with_mouse.png, /blog/images/ergodox_ez_final_with_mouse.png 1.5x, /blog/images/ergodox_ez_final_with_mouse.png 2x"
        data-sizes="auto"
        alt="/images/ergodox_ez_final_with_mouse.png"
        title="Final ErgoDox assembly with mouse" /></p>
<p>I decided to forgo one key near the thumb for better mouse placement, as I figured I&rsquo;d be using the trackball a lot. I also debated drilling some holes and having the mouse hang off the bottom fo the ErgoDox a bit so that I could keep the full keyset, but that required more commitment than I was willing to do for the moment, maybe in the future!</p>
<h2 id="final-remarks">Final Remarks</h2>
<p>I&rsquo;ve modified <code>drashna</code>&rsquo;s original code quite a bit, and hopefully improved upon the mouse behavior. One of the tricky things about the trackball is it&rsquo;s very small, so it makes it difficult to get the right sensitivity at the right time. When clicking small UI elements like the <code>X</code> button you want precision, but other times you need to get the mouse to the other side of the screen and don&rsquo;t want to be flicking your thumb 20 times. I&rsquo;m still tweaking the code, but I&rsquo;ve settled on something that seems to work okay for now. The gist is:</p>
<ol>
<li>Use an exponential acceleration</li>
<li>Tier the acceleration to different ranges, so when the trackball returns small values assume the user is trying to be precise and don&rsquo;t over-accelerate</li>
<li>if the values are in the middle apply a bit more of a multiplier to get the mouse moving more</li>
<li>if it&rsquo;s a high value assume the user did a giant flick to get across the screen</li>
</ol>
<p>This seems to trick a decent balance, although getting the number ranges correct is a bit tricky. I&rsquo;m sure there&rsquo;s smarter solutions to this problem, but this seems to work for now&hellip;</p>
<p>A couple extras I added are:</p>
<ul>
<li>Add a &ldquo;please accelerate a lot right now&rdquo; button that bumps the multiplier to a high value without trying to be smart</li>
<li>Scroll mode (although drashna already had this) that&rsquo;s dampened a bit, seems to be nicer scrolling on web</li>
<li>Add support for left/middle/right click/release. The normal ErgoDox mouse bindings seem to send a full mouse click on key press. I wanted something that would simulate a normal mouse button where the release didn&rsquo;t happen until the key was released. These are custom key codes that are sent with the mouse message.</li>
</ul>
<h2 id="code">Code</h2>
<p>I&rsquo;ve <a href="https://github.com/laser-turtle/ergodox-ez-trackball" target="_blank" rel="noopener noreffer">uploaded the modified firmware files here</a>. It&rsquo;s not the best code, but it works! It may require some tweaking for your particular setup. A lot of the acceleration/multipliers depend on how far you tend to flick your thumb. Also, this would be the perfect time to show a video, unfortunately I&rsquo;m still new to the ErgoDox and the video would be me fumbling around trying to remember my key bindings. So maybe sometime in the future!</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2020-08-29</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/blog/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/blog/posts/incr-dom-3/" class="prev" rel="prev" title="Getting Started With Incr_dom - Part 3"><i class="fas fa-angle-left fa-fw"></i>Getting Started With Incr_dom - Part 3</a>
            <a href="/blog/posts/math-battle/" class="next" rel="next" title="Math Battle">Math Battle<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.88.1">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/blog/" target="_blank"></a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><script type="text/javascript" src="/blog/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/blog/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/blog/lib/clipboard/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":-1},"comment":{}};</script><script type="text/javascript" src="/blog/js/theme.min.js"></script></body>
</html>
